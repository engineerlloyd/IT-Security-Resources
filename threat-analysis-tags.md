#THREAT ANALYSIS INCIDENT RESPONSE##THREAT HUNTING/ANALYSIS TERMS TO MINDosi 7 layers, http, internet backbone, ISPs, Tiers.routers, switches, hubs, servers, clients, IOT devices.server types, web, mail, dns, web caches.web crawlers, spiders, indexes, search engines, web scraping.URLS, html, css, DOM, CMS (content management systems).javascript, nodejs, php, asp, asp.net.c, c++, c#, java, vb, vb script, powershell.google dorking, GHDB (google hacking database).registry comparisons/monitoring, network sniffing/monitoring.process exploration, execution of malware in regulated environment, malware network traffic, pcap files.C & C (command and control) network traffic.malvertising, spyware, spam,adware, freeware, shareware.virus, worm, keylogger, trojan, rootkit, APT malware.downloaders, droppers, fileless malware, http backdoors.virus types, system infector, boot infector, file infector, macro virus, CIH (chernobyl), RavMon.exe, Brain, Anna Kournikova virus.worm types, Mydoom, Sasser, Blaster, Mylife, Melissa, Morris.trojan types, Gh0st RAT, Zeus, TinyBanker, Netbus, FinFisher, Clickbot.A, Magic Lantern, WARRIOR PRIDE, Shendun.rootkit types, NTRootkit, Sony BMG rootkit.phish, ransomware, grayware, code injection, hooking.persistance techniques, hiding malware from live forensics tools.detecting stealthed and advanced malware.IOC (indicators of compromise), network IOCs, host based IOCs.acquire memory from infected pc.ransomware types, WanaCry, Reveton, CryptoLocker, CryptoWall, Fusob.ways to spread, types of attack, lateral movement.drive by download, homogeneity, backdoor, vulnerability.exploit, 0day, privilege escalation, evasion, blended threat.botnet, endpoint, payload, signature, threat, track, zombie.event/log files, SIEM data, sigs, hashes, OTX open threat exchange.windows internals, windows startup steps/process, windows permissions/user accts.threat targets, threat actor TTPs (tactics, techniques, procedures), vulnerabilities, easy/popular/past targets.threat intelligence platforms, threat intel websites, malware analysis lab.static analysis steps, malware metadata, dynamic analysis steps.malware interactions with file system, processes, registry, networks.malware fingerprinting, extracting strings, file obfusication/packing, YARA pattern matching.fuzzing hashing & comparison, PE file characteristics.simulating services/network/www connections, monitor process/file/registry/network activity.determine IOCs, automated malware analysis sandboxes, sandbox features.malware persistance methods, run registry key, scheduled tasks, startup folder, service, winlogin registry entries.IFEO (image file execution options), accessibility apps, AppInit_DLLs, DLL search order hijacking, COM hijacking.asm & disassembly concepts, binary basics, cpu registers, data transfer instructions, math operations, bitwise operations.branching & conditionals, loops, functions, arrays, strings, structures, x64 vs 32b.code analysis, disassemblers & debuggers, honeypots.reversing malware, functionalities of downloaders/droppers, keyloggers, malware replication, C & C.process injection techniques, remote dll injection, dll inj using APC, remote executable/shellcode inj.hollow process inj, dll inj using SetWindowsHookEx(), dll inj using app shims.mem forensics, why use memory forensics & steps, mem acquisition from physical & virtual machines, Volatility tool.investigating processes, process internals, EPROCESS structure, process organization, enumeration by walking double linked list.process relationships, parent/child, DKOM attacks, enumeration using pool tag scanning, tools to enumerate processes.identifying malware processes, malware infected memory.process handles & registry, objects and handles, enumerating process handles, Mutex, detecting malware using mutex.investigate common registry keys, detecting malware persistance.investigate network activities, malware network signs, network tools, malware network connections, malware & Sockets.investigate process memory, process memory internals, listing dlls, identifying hidden dlls.dumping malicious executable from memory, dumping dlls from memory, scan memory for patterns/yara.investigate user mode rootkits & fileless malware, code injection/types, remote dll injection, remote code inj, reflective dll inj.investigate kernel mode rootkits, rootkit internals, functional call traversal in windows, level of hooking/modication on windows.hunt APT malware from memory.##THREAT ANALYSIS PROCEDURES TO KEEP IN MIND###*analyze suspect file/binary/document/pdf/office docs/macros:                                    https://zeltser.com/analyzing-malicious-documents/.###*analyze suspect processes:###*analyze "autoruns/run at boot" processes/changes:                                               https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns.###*analyze registry changes:###*analyze windows event logs:###*analyze network traffic:###*analyze user accts/permissions changes:###*analyze memory dumps from running processes/executables:###*analyze further by reverse engineering/disassembling/debuging:###link network traffic to processes:###link urls & identify urls in network traffic to executables:###link registry changes to executables:###link autoruns/startup programs to executables:###link log/event entries to processes:###link windows permissions/user accts changes to processes:###analyze windows system in safe mode:                                                             https://www.lifewire.com/boot-into-safe-mode-153370.###analyze/reconfigure windows with safe mode boot usb/tools/cmds:                                  https://www.intowindows.com/boot-windows-10-in-safe-mode-when-pc-is-not-booting/.###hunt phishing sources & forwardtrace & backtrace their actions/events/downloads:###hunt malicious downloads & backtrace their urls with grayhat tactics:###run malicious dls on safe pc & backtrace their network traffic:###run malicious document macros & analyze their changes to the system:###submit suspect files for analysis online:###hypothesize threat actors targets/targetable orgs/downloads/urls/geolocations:###hypothesize threat actors PPTs & :###hypothesize with & analyze SIEM data into organized actionable info/intel:##DOWNLOADS/APPS###gvim:                                     text editor:                                           https://www.vim.org/download.php.###firefox:                                  browser:                                               https://www.mozilla.org/en-US/firefox/new/.###7zip:                                     compressor:                                            https://www.7-zip.org/.###wireshark:                                pcap viewer, network sniffer:                          https://www.wireshark.org/.###wxhexeditor:                              hexeditor:                                             http://www.wxhexeditor.org/.###sysinternals suite:                       windows system utilities:                              https://docs.microsoft.com/en-us/sysinternals/downloads/.###PE explorer:                              analyze PE files:                                      http://www.pe-explorer.com/peexplorer-download.htm.###PE insider:                               analyze PE files:                                      https://cerbero.io/peinsider/.###PEview:                                   view PE files:                                         http://wjradburn.com/software/.###LordPE:                                   PE file utility:                                       https://www.aldeid.com/wiki/LordPE.###IDA Hex Rays:                             reversing code, debugger:                              https://www.hex-rays.com/products/ida/support/download_freeware.shtml.###cff explorer:                             debugger, re, unpacker, modify relocation table:       https://ntcore.com/?page_id=388.###CHimpRec:                                 import rebuilder:                                      https://www.aldeid.com/wiki/CHimpREC.###API Monitor:                              intercept API funcion calls:                           http://www.rohitab.com/apimonitor.###WinHex:                                   view hex and checksums:                                http://www.winhex.com/winhex/.###Hiew:                                     disassembler, modify executed statements:              http://www.hiew.ru/.###Fiddler:                                  traffic sniffer proxy:                                 https://www.telerik.com/fiddler.###Scylla:                                   imports reconstructor:                                 https://github.com/NtQuery/Scylla.###PEiD:                                     detect packers:                                        https://www.aldeid.com/wiki/PEiD.###Relocation Section Editor:                edit relocation table:                                 https://github.com/mohic/Relocation-Section-Editor.###x64dbg:                                   debugger, re:                                          https://x64dbg.com/#start.###OllyDbg:                                  debugger, re:                                          http://www.ollydbg.de/.###Binary Ninja:                             reverse engineering platform:                          https://binary.ninja/.###radare2:                                  reverse engineering framework:                         https://www.radare.org/r/.###Immunity Debugger:                        malware analysis:                                      https://www.immunityinc.com/products/debugger/.###WinDbg:                                   debugger:                                              https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools.###Relyze:                                   reverse engineering platform:                          https://www.relyze.com/.###PEBrowse Pro:                             static analysis, disassembler:                         https://download.cnet.com/PEBrowse-Professional-64-bit/3000-2218_4-75176627.html.###Regshot:                                  windows registry utility:                              https://sourceforge.net/projects/regshot/files/latest/download.###regedit.exe:                              default win registry editor:                           https://www.akadia.com/services/windows_registry_tutorial.html.###MSConfig:                                 windows startup troubleshoot utility:                  https://en.wikipedia.org/wiki/MSConfig.###Volatility:                               multi platform memory forensics:                       https://www.volatilityfoundation.org/.###fakenet:                                  simulate network connections/www:                      https://github.com/fireeye/flare-fakenet-ng.##ONLINE RESOURCES###pastebin:                                 cloud space for text files/malware:                    https://pastebin.com/.###anyrun:                                   malware/file analysis:                                 https://any.run/.###virustotal:                               virus signatures, known malware:                       https://www.virustotal.com/#/home/upload.###malwr:                                    malware threat intel:                                  https://malwr.com/.###malware traffic analysis:                 historical malware intel:                              http://malware-traffic-analysis.net/.###joe sandbox:                              malware/file analysis:                                 https://www.joesandbox.com/.###raytheon forcepoint:                      URL analysis:                                          https://csi.websense.com/.###MxToolbox:                                MX domain email analysis, domain troubleshooting:      https://mxtoolbox.com/.###contagio:                                 malware dump:                                          http://contagiodump.blogspot.com/.###Das Malwerk:                              malware samples:                                       http://dasmalwerk.eu/.###virusign:                                 virus malware hashes files updates:                    http://dasmalwerk.eu/.###malshare:                                 malware files:                                         https://malshare.com/.###kernelmode:                               re, os internals, malware analysis:                    http://www.kernelmode.info/forum/.###AlienVault OSSIM:                         open source SIEM data:                                 https://www.alienvault.com/products/ossim?utm_source=bing&utm_medium=cpc&utm_term=kwd-28671925126:loc-190&utm_campaign=USM-NA-MSN-SE&_bt=15959456400&msclkid=f4b0c803a34f13a240d993d27d236c8a&utm_content=Open%20Source%20SIEM.##ONLINE REFS###google dorking webopedia:                 deep info search with google:                          https://www.webopedia.com/TERM/G/google-dorking.html.###google-dorking.com:                       pentesting with google:                                http://www.google-dorking.com/.###google dorking nullbyte:                  google dorks tutorial:                                 https://null-byte.wonderhowto.com/how-to/use-google-hack-googledorks-0163566/.###google dorks basics cybrary:              basic google dorks:                                    https://www.cybrary.it/0p3n/google-dorks-easy-way-of-hacking/.###google dorks basics tut-house:            basic google dorking:                                  https://tut-house.blogspot.com/2015/01/how-to-use-google-dorks-google-dork.html#.###google dorks cybrary.it:                  advanced google dorks:                                 https://www.cybrary.it/0p3n/advanced-google-dorking-commands/.###windows registry reference:               win registry conventions:                              https://docs.microsoft.com/en-us/windows/desktop/SysInfo/registry-reference.###siem data guide:                          security info event management:                        ###https://en.wikipedia.org/wiki/Security_information_and_event_management.###windows run on boot processes:            guide on processes running on boot/startup:            https://support.microsoft.com/en-us/help/835638/take-control-of-your-windows-start-up.###msconfig:                                 msconfig guide:                                        https://answers.microsoft.com/en-us/windows/forum/windows_10-update/msconfig-the-system-configuration-tool/273dea8e-4cbe-47e9-8489-f400e879ce17.###windows permissions/user accts:           guide on win permissions/user accts:                   http://techgenix.com/understanding-windows-ntfs-permissions/.###windows 10 recovery usb:                  create win 10 usb:                                     http://techzend.com/how-to-create-a-recovery-repair-usb-drive-in-windows-10/.###windows 7 recovery usb:                   create win 7 usb:                                      https://www.intowindows.com/how-to-repair-windows-7-from-usb-flash-drive-repair-without-installation-dvd-disc/.###windows 8 safe mode guide:                win 8 safe mode tutorial:                              https://www.eightforums.com/threads/safe-mode-start-windows-8-in.2757/.###windows 8 recovery cli:                   win 8 recovery guide:                                  https://www.bleepingcomputer.com/tutorials/windows-8-recovery-environment-command-prompt/.###Volatility:                               memory forensics guide:                                http://www.hackingarticles.in/memory-forensics-investigation-using-volatility-part-1/.##HONEYPOTS###honeydrive:                               preconfigured honeypot:                                https://bruteforcelab.com/honeydrive.##CLI##LOGS